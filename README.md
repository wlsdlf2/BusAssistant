# 🚌 BusAssistant (시각장애인 버스 탑승 지원 서비스)

## 1. 프로젝트 소개
BusAssistant는 **시각장애인의 버스 탑승 접근성을 개선**하기 위한 서비스입니다.  
버스정류장에 설치된 **라즈베리파이(점자 키패드 + 스피커)** 단말에서 시각장애인이 탑승하려는 버스 번호를 입력하면, 공공데이터 API를 호출하여 **버스 도착 예정 시간(N분 후 도착)을 음성(TTS)으로 안내**합니다.

또한 동시에 해당 입력 이벤트를 백엔드로 전송하여, **버스 기사 전용 안드로이드 앱**에  
“어느 정류장에서 시각장애인 승객이 탑승 예정인지”를 알림으로 전달합니다.

이를 통해 기사와 승객의 매칭을 돕고, 시각장애인이 보다 안전하고 원활하게 탑승할 수 있도록 지원합니다.

---

## 2. 프로젝트 목표
- 시각장애인이 **정류장에서 버스 도착 정보를 음성으로 안내**받을 수 있도록 지원
- 시각장애인의 탑승 요청을 기사에게 전달하여 **탑승 지원이 가능하도록** 개선
- 라즈베리파이(IoT) + Spring 백엔드 + Android 앱을 연동한 **End-to-End 시스템 구현**

---

## 3. 시스템 구성
본 프로젝트는 아래 3가지 구성 요소로 이루어져 있습니다.

### (1) Raspberry Pi (Python)
- 점자 키패드 입력(GPIO 4x4 Keypad)
- 스피커를 통한 음성 안내(TTS)
- 공공데이터 API 호출 및 XML 파싱
- Spring 서버로 버스 등록 요청 전송(JSON POST)

### (2) Spring Boot Backend (Java)
- 라즈베리파이 입력 데이터를 수신하여 저장(메모리 저장소 기반)
- 공공데이터 API(경기도 버스도착정보) 호출
- 버스가 특정 조건(예: 2정거장 전)에 도달하면 기사 앱에 알림 트리거 응답

### (3) Android App (Java + Retrofit)
- 기사(운전자)가 운행 중인 버스 번호 입력(로그인)
- 5초마다 서버를 조회(폴링)하여 탑승 예정 알림 수신
- 알림 수신 시 TTS로 음성 안내

---

## 4. 주요 기능

### ✅ 시각장애인 정류장 단말(라즈베리파이)
- 점자 키패드로 버스 번호 입력
- 버스번호 → routeId 변환(공공데이터 API)
- 해당 버스가 정류장에 정차하는지 검증
- 등록 성공 시 “N분 후 도착 예정” 음성 안내(TTS)
- 서버에 탑승 요청 데이터 전송

### ✅ 기사 전용 앱(안드로이드)
- 기사 버스 번호 입력 후 로그인
- 5초 주기로 서버 조회(폴링)
- 탑승 요청 발생 시  
  **“OO정류장에서 시각장애인 승차 예정입니다”** 음성 안내(TTS)

### ✅ 백엔드(Spring Boot)
- 라즈베리파이 등록 데이터 수신 및 저장
- 경기도 버스도착정보 API(getBusArrivalItem) 호출
- XML 파싱을 통해 버스 위치(locationNo1) 등 정보 확인
- 조건 만족 시 alarm=1 응답(중복 알림 방지 로직 포함)

---

## 5. 동작 흐름(시나리오)

### 1) 시각장애인
1. 정류장 라즈베리파이 단말에서 점자 키패드로 버스 번호 입력
2. 시스템이 버스 도착 예정 시간을 조회
3. “N분 후 도착 예정입니다”를 음성으로 안내
4. 동시에 서버에 탑승 요청 전송

### 2) 버스 기사
1. 기사 앱에서 본인의 버스 번호 입력 후 로그인
2. 앱이 5초마다 서버를 조회
3. 버스가 정류장 근처(예: 2정거장 전)에 도달하면 알림 발생
4. “OO정류장에서 시각장애인 승차 예정입니다” 음성 안내

---

## 6. 사용 공공데이터 API
- 경기도 버스도착정보 API  
  `http://apis.data.go.kr/6410000/busarrivalservice/getBusArrivalItem`

- 버스 노선 조회(버스번호 → routeId 변환) API 사용

---

## 7. API 명세 (Spring Backend)

### 1) 라즈베리파이 → 서버 (정류장/버스 등록)
**POST `/busStopData`**

Request Body:
```json
{
  "stationId": "233000945",
  "routeId": "000000000",
  "busNumber": "000"
}
